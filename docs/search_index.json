[
["relaciones-entre-variables.html", "Capítulo 12 Relaciones entre variables 12.1 Tablas de contingencia 12.2 Riesgo relativo 12.3 Odds ratio 12.4 Intensidad de la asociación 12.5 Coeficiente Phi de Pearson-Yule (\\(\\varphi\\))", " Capítulo 12 Relaciones entre variables Hasta aquí hemos venidos trabjando principalmente con medidas de resúmenes, tablas y gráficos para variables individuales. Muchas veces interesa obervar como las variables se comportan conjuntamente. Para ello, también haremos uso de tablas, gráficos y medidas de resúmenes. En términos técnicos, lo que nos interesesa es explicar la variabilidad. Podemos explicar parcialmente la variabilidad de una variable conociendo los valores de otras variables que estén asociadas. Diremos que existe asociación de variables cuando la variación de una de ellas influya en la variación de las otras. Por ejemplo, el peso y la altura son dos variables que están asociadas. Esperaríamos que las personas que son más altas sean, en promedio, mas pesadas que aquellas que son más bajas. Diremos que dos variables son independientes cuando la variación de una de ellas no afecta la variación de la otra. 12.1 Tablas de contingencia Son llamadas también tablas de distribución conjunta, tablas bivariadas o tablas cruzadas. Permite obervar la relación entre variables cualitativas. Se representan las categorías de una variables en las filas, y las categorías de la otra en las columnas, y se pueden calcular diferentes tipos de frecuencias absolutas o relativas. Supongamos que queremos observar la relación entre la prevalencia de consumo con el riesgo percibido para el consumo frecuente de alcohol (BIBA14_02). ## Prevalencia de consumo del último mes y riesgo percibido ## Alcohol riesgo_perc &lt;- factor(enprecosp$BIBA14_02, labels = c(&quot;Ningún riesgo&quot;, &quot;Riesgo leve o moderado&quot;, &quot;Gran riesgo&quot;, &quot;No sé que riesgo corre&quot;)) prev_mes &lt;- factor(enprecosp$P1M_BA, labels = c(&quot;Sí&quot;, &quot;No&quot;)) ## Realizamos una tabla de frecuencias absolutas conjunta tc &lt;- table(riesgo_perc, prev_mes) tc ## prev_mes ## riesgo_perc Sí No ## Ningún riesgo 202 61 ## Riesgo leve o moderado 1701 1139 ## Gran riesgo 14261 16601 ## No sé que riesgo corre 163 215 En estas tablas también se pueden expresas las frecuencias marginales. Las frecuencias marginales son los totales por fila y por columna. Se corresponden con las frecuencias univariadas para cada una de las variables. ## Frecuencias marginales addmargins(tc) ## prev_mes ## riesgo_perc Sí No Sum ## Ningún riesgo 202 61 263 ## Riesgo leve o moderado 1701 1139 2840 ## Gran riesgo 14261 16601 30862 ## No sé que riesgo corre 163 215 378 ## Sum 16327 18016 34343 También podemos calcular las frecuencias relativas ## Frecuencias relativas al total tc_tot &lt;- prop.table(tc) tc_tot &lt;- addmargins(tc_tot) format(tc_tot, digits = 0, nsmall = 4) ## prev_mes ## riesgo_perc Sí No Sum ## Ningún riesgo &quot;0.0059&quot; &quot;0.0018&quot; &quot;0.0077&quot; ## Riesgo leve o moderado &quot;0.0495&quot; &quot;0.0332&quot; &quot;0.0827&quot; ## Gran riesgo &quot;0.4153&quot; &quot;0.4834&quot; &quot;0.8986&quot; ## No sé que riesgo corre &quot;0.0047&quot; &quot;0.0063&quot; &quot;0.0110&quot; ## Sum &quot;0.4754&quot; &quot;0.5246&quot; &quot;1.0000&quot; ## Frecuencias relativas por filas tc_fila &lt;- addmargins(tc, 1) tc_fila &lt;- prop.table(tc_fila, 1) format(tc_fila, digits = 0, nsmall = 4) ## prev_mes ## riesgo_perc Sí No ## Ningún riesgo &quot;0.7681&quot; &quot;0.2319&quot; ## Riesgo leve o moderado &quot;0.5989&quot; &quot;0.4011&quot; ## Gran riesgo &quot;0.4621&quot; &quot;0.5379&quot; ## No sé que riesgo corre &quot;0.4312&quot; &quot;0.5688&quot; ## Sum &quot;0.4754&quot; &quot;0.5246&quot; ## Frecuencias relativas por columna tc_col &lt;- addmargins(tc, 2) tc_col &lt;- prop.table(tc_col, 2) format(tc_col, digits = 0, nsmall = 4) ## prev_mes ## riesgo_perc Sí No Sum ## Ningún riesgo &quot;0.0124&quot; &quot;0.0034&quot; &quot;0.0077&quot; ## Riesgo leve o moderado &quot;0.1042&quot; &quot;0.0632&quot; &quot;0.0827&quot; ## Gran riesgo &quot;0.8735&quot; &quot;0.9215&quot; &quot;0.8986&quot; ## No sé que riesgo corre &quot;0.0100&quot; &quot;0.0119&quot; &quot;0.0110&quot; 12.2 Riesgo relativo Enfermo Saludable Expuesto \\[D_e\\] \\[H_n\\] No Expuesto \\[D_n\\] \\[H_n\\] 12.3 Odds ratio 12.4 Intensidad de la asociación Las medidas de asociación nos permiten evaluar el grado o intensidad de la relación entre las variables. 12.4.1 Q de Kendall - Yule El Q de Kendall-Yule es una medida de intensidad de asociación para variables dicotómicas. Supongamos que tenemos la siguiente tabla de doble entrada: Sí No Total Positiva a b a+b Negativa c d c+d Total a+c b+d n El coeficiente de Q es: \\[ Q = \\frac{ad - bc}{ad + bc} \\] Evaluemos si el sexo está relacionado con la prevalencia mensual de consumo de alcohol. sexo &lt;- factor(enprecosp$BHCH04J, labels = c(&quot;Varón&quot;, &quot;Mujer&quot;)) prev_alcohol &lt;- factor(enprecosp$P1M_BA, labels = c(&quot;Sí&quot;, &quot;No&quot;)) tc &lt;- table(sexo, prev_alcohol) tc ## prev_alcohol ## sexo Sí No ## Varón 11378 11434 ## Mujer 4949 6582 ## Veamos el grado de asociación a &lt;- tc[1,1] b &lt;- tc[1,2] c &lt;- tc[2,1] d &lt;- tc[2,2] ## Calculamos el coeficiente Q de Kendall-Yule Q &lt;- (a*d-b*c)/(a*d+b*c) Q ## [1] 0.1392118 12.4.2 Chi cuadrado (\\(\\chi^2\\)) ## Riesgo leve percibido ## En su opinión, ¿cuál cree usted que es el riesgo que ## corre una persona que toma bebidas alcohólicas de vez ## en cuando riesgo_perc &lt;- factor(enprecosp$BIBA14_01, labels = c(&quot;Ningún riesgo&quot;, &quot;Riesgo leve o moderado&quot;, &quot;Gran riesgo&quot;, &quot;No sé qué riesgo&quot;)) # prop.table(table(riesgo_perc)) prev_alcohol &lt;- factor(enprecosp$P1M_BA, labels = c(&quot;Sí&quot;, &quot;No&quot;)) tc &lt;- table(riesgo_perc, prev_alcohol) ## Calculamos las frecuencias esperadas y observadas chi &lt;- chisq.test(tc) chi$observed ## prev_alcohol ## riesgo_perc Sí No ## Ningún riesgo 4153 2813 ## Riesgo leve o moderado 7432 7309 ## Gran riesgo 4549 7622 ## No sé qué riesgo 193 272 chi$expected ## prev_alcohol ## riesgo_perc Sí No ## Ningún riesgo 3311.7049 3654.2951 ## Riesgo leve o moderado 7008.0164 7732.9836 ## Gran riesgo 5786.2131 6384.7869 ## No sé qué riesgo 221.0656 243.9344 chi_val &lt;- chi$statistic; chi_val ## X-squared ## 967.376 12.5 Coeficiente Phi de Pearson-Yule (\\(\\varphi\\)) \\[ \\varphi = \\sqrt{\\frac{\\chi^2}{n}} \\] sexo &lt;- factor(enprecosp$BHCH04J, labels = c(&quot;Varón&quot;, &quot;Mujer&quot;)) prev_alcohol &lt;- factor(enprecosp$P1M_BA, labels = c(&quot;Sí&quot;, &quot;No&quot;)) tc &lt;- table(sexo, prev_alcohol) chi &lt;- chisq.test(tc) chi_val &lt;- chi$statistic n &lt;- sum(tc) phi &lt;- sqrt(chi_val/n) 12.5.1 Coeficiente de contingencia C de Pearson Mide el grado de asociación en tablas de contingencia con más de dos categorías. \\[ C = \\sqrt{\\frac{\\chi^2}{\\chi^2 + n}} \\] Va de 0 a 1 y se compara con un C máximo: \\[ C_{max} = \\sqrt{\\frac{min(f, c) - 1}{min(f, c)}} \\] Donde: \\(f\\) es el número de filas \\(g\\) es el número de columnas ## Riesgo leve percibido ## En su opinión, ¿cuál cree usted que es el riesgo que ## corre una persona que toma bebidas alcohólicas de vez ## en cuando riesgo_perc &lt;- factor(enprecosp$BIBA14_01, labels = c(&quot;Ningún riesgo&quot;, &quot;Riesgo leve o moderado&quot;, &quot;Gran riesgo&quot;, &quot;No sé qué riesgo&quot;)) # prop.table(table(riesgo_perc)) prev_alcohol &lt;- factor(enprecosp$P1M_BA, labels = c(&quot;Sí&quot;, &quot;No&quot;)) tc &lt;- table(riesgo_perc, prev_alcohol) ## Calculamos las frecuencias esperadas y observadas chi &lt;- chisq.test(tc) chi$observed ## prev_alcohol ## riesgo_perc Sí No ## Ningún riesgo 4153 2813 ## Riesgo leve o moderado 7432 7309 ## Gran riesgo 4549 7622 ## No sé qué riesgo 193 272 chi$expected ## prev_alcohol ## riesgo_perc Sí No ## Ningún riesgo 3311.7049 3654.2951 ## Riesgo leve o moderado 7008.0164 7732.9836 ## Gran riesgo 5786.2131 6384.7869 ## No sé qué riesgo 221.0656 243.9344 chi_val &lt;- chi$statistic; chi_val ## X-squared ## 967.376 ## Calculamos el C de Pearson f &lt;- nrow(tc) c &lt;- ncol(tc) n &lt;- sum(tc) C &lt;- sqrt(chi_val/(chi_val + n)); C ## X-squared ## 0.1655185 Cmax &lt;- sqrt((min(f, c) - 1) / min(f, c)); Cmax ## [1] 0.7071068 12.5.2 Coeficiente V de Cramer \\[ V = \\sqrt{\\frac{\\chi^2}{n * min(f - 1, c-1)}} \\] V &lt;- sqrt(chi_val/(n * min(ncol(tc), nrow(tc)))) "]
]
